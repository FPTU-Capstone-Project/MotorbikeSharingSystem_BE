spring.application.name=MotorbikeSharingSystem_BE


springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.config-url=/v3/api-docs/swagger-config
springdoc.swagger-ui.url=/v3/api-docs
springdoc.swagger-ui.enabled=true
springdoc.api-docs.enabled=true

# Enable Spring Boot to throw NoHandlerFoundException for unmapped requests
spring.web.resources.add-mappings=false

spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/motorbike_sharing_db}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:1234567}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

security.jwt.secret-key=${JWT_SECRET:TrKrJbBTYVVF/pUplsiCPLbtjy1ElhBVMM2M+ABPn/0FSTbo/TY2JTTWA0LsG5t89d7W3wGzUTuoznjmLWMpvTF61KhA3TgMxEc1BXe/fLrTYhCShOcUar6MFpyd4jTbrgYrSYh2JcyCi0mc+Nhra0hKk0c/BEKkYMBEkrlpTlxp+NeEv+oy5vAYtOh/GAtQxNu2+9nUPsEQw7EuxzLTHqlU09QcbBkAjLgrqcZJwAE4LojbZRZf9nys1B81tAp9TDa8hmWDuIH+vm/bAOk8f/POWXFQxyVEBOaSKjDmGT0wqrHTRRoUmNexljZRvPeMx520dv4mECYonbq/VCauEu/eFQXcWMQFDBnu5s5Tv8KMid4JaEiWe8xz7aB7EredVUfyZx9LFZPhVeqEcOD2UdeWunmEfWthxUvG3TwxITUecLxh4ngn+EiBKNsyjrRUfIGhCSOIDsnloRHuoDbGwep3uP4ZwwNNDFeYimbivHaRoy42Qm7Fmk/Gxi6JrqWGSLjUh3cwTn5ZefzBPWdKALp3YwsvZLypxi3WzodEAaZdpFdYIZn0I46eE5L8baLs19NjiKyVzdwzQcHN/Gy5KsJY2jQWQNW2lcBxpv42dY/vpsLYZ3alyIj/jszLEN6lQgoKPIhcLm1t2OXiLpE6ponX8+HqxRseOV0Y80f8uA8=}
security.jwt.expiration-time=${JWT_EXPIRATION_TIME:3600000}
security.jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:86400000}

payos.client-id=${PAYOS_CLIENT_ID:a24cd178-c9b1-43ed-b542-7329036a6ded}
payos.api-key=${PAYOS_API_KEY:e0da6dbd-ce2e-49f7-a873-e6abcad72702}
payos.checksum-key=${PAYOS_CHECKSUM_KEY:649b878997b1c3f1fca411836c612e06a4d1b68b6d635a8e55329dcfc0faf41a}
payos.return-url=${PAYOS_RETURN_URL:http://localhost:8080/api/v1/payos/return}
payos.cancel-url=${PAYOS_CANCEL_URL:http://localhost:8080/api/v1/payos/cancel}

app.version=1.0.0

spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=true
spring.flyway.out-of-order=false


logging.level.org.springdoc=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.com.mssus.app.service.impl.RideMatchingServiceImpl=DEBUG
logging.level.org.springframework.web.socket=DEBUG
logging.level.org.springframework.messaging=DEBUG
logging.level.com.mssus.app.config=DEBUG
logging.level.org.flywaydb=DEBUG
logging.level.org.flywaydb.core=DEBUG
logging.level.org.flywaydb.core.internal=DEBUG
logging.level.com.mssus.app=DEBUG

# Email Configuration
app.email.jwt-secret=${JWT_SECRET:TrKrJbBTYVVF/pUplsiCPLbtjy1ElhBVMM2M+ABPn/0FSTbo/TY2JTTWA0LsG5t89d7W3wGzUTuoznjmLWMpvTF61KhA3TgMxEc1BXe/fLrTYhCShOcUar6MFpyd4jTbrgYrSYh2JcyCi0mc+Nhra0hKk0c/BEKkYMBEkrlpTlxp+NeEv+oy5vAYtOh/GAtQxNu2+9nUPsEQw7EuxzLTHqlU09QcbBkAjLgrqcZJwAE4LojbZRZf9nys1B81tAp9TDa8hmWDuIH+vm/bAOk8f/POWXFQxyVEBOaSKjDmGT0wqrHTRRoUmNexljZRvPeMx520dv4mECYonbq/VCauEu/eFQXcWMQFDBnu5s5Tv8KMid4JaEiWe8xz7aB7EredVUfyZx9LFZPhVeqEcOD2UdeWunmEfWthxUvG3TwxITUecLxh4ngn+EiBKNsyjrRUfIGhCSOIDsnloRHuoDbGwep3uP4ZwwNNDFeYimbivHaRoy42Qm7Fmk/Gxi6JrqWGSLjUh3cwTn5ZefzBPWdKALp3YwsvZLypxi3WzodEAaZdpFdYIZn0I46eE5L8baLs19NjiKyVzdwzQcHN/Gy5KsJY2jQWQNW2lcBxpv42dY/vpsLYZ3alyIj/jszLEN6lQgoKPIhcLm1t2OXiLpE6ponX8+HqxRseOV0Y80f8uA8=}
app.email.verification-token-ttl=PT24H
app.email.rate-limit.max-attempts-per-hour=5

# Email Provider Configuration - Gmail SMTP
app.email.gmail-smtp.enabled=${GMAIL_SMTP_ENABLED:true}

# Gmail SMTP Configuration
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${GMAIL_USERNAME:neurapixai@gmail.com}
spring.mail.password=${GMAIL_APP_PASSWORD:jtkwwnhxxuahzvyn}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com

# SMS Configuration
app.sms.verification-code-ttl=PT10M
app.sms.rate-limit.max-attempts-per-hour=3

# SMS Provider Configuration
app.sms.aws-sns.enabled=${AWS_SNS_ENABLED:true}

# Redis Configuration for Rate Limiting and Caching
spring.data.redis.url=rediss://red-d448uv8dl3ps73anism0:iO4dAIwHhveMco0sOxWObLH0MZw20fpd@oregon-keyvalue.render.com:6379
spring.data.redis.ssl.enabled=true
spring.cache.type=none
#spring.data.redis.host=${REDIS_HOST:rediss://red-d448uv8dl3ps73anism0:iO4dAIwHhveMco0sOxWObLH0MZw20fpd@oregon-keyvalue.render.com}
#spring.data.redis.port=${REDIS_PORT:6379}
#spring.data.redis.password=${REDIS_PASSWORD:}
#spring.data.redis.database=${REDIS_DATABASE:0}
#spring.data.redis.timeout=2000ms
#spring.cache.type=none


# Thymeleaf Configuration for Email Templates
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false

# Application URL Configuration
app.frontend.base-url=${FRONTEND_BASE_URL:http://localhost:3000}
app.backend.base-url=${BACKEND_BASE_URL:http://localhost:8080}
app.email.from-address=${EMAIL_FROM_ADDRESS:motorbikesharingcap@gmail.com}
app.email.from-name=${EMAIL_FROM_NAME:Motorbike Sharing System}

cloudinary.cloud-name=${CLOUDINARY_CLOUD_NAME:dsqp0rehs}
cloudinary.api-key=${CLOUDINARY_API_KEY:564567553838972}
cloudinary.api-secret=${CLOUDINARY_API_SECRET:So_4R1YrkMJ-Rh9DfUsx6xRDYs8}
cloudinary.folder=motorbike


# File Upload Configuration
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB
spring.servlet.multipart.enabled=true

fpt.ai.api-key=${FPT_AI_API_KEY:brPoCc17ijOCsF1pp9BsAp4prKx1bCqH}

osrm.base-url=${OSRM_BASE_URL:http://router.project-osrm.org/route/v1/driving/}
goong.base-url=https://rsapi.goong.io/Direction
goong.api-key=${GOONG_API_KEY:0wfldOkiVmb1eeKjtwnOV1InDkoB1izWGxBPXNvc}

routing.provider=osrm

firebase_credentials=${FIREBASE_CREDENTIALS}


# Request Acceptance Timeout (ISO 8601 Duration format)
# Total matching window: 15 minutes (sequential + broadcast phases combined)
app.ride.request-acceptance-timeout=PT15M

# AI Matching Algorithm Configuration
app.ride.matching.max-pickup-detour-minutes=10
app.ride.matching.max-dropoff-detour-minutes=15
app.ride.matching.time-window-minutes=15
app.ride.matching.max-proposals=10
app.ride.matching.scoring-weights.proximity=0.4
app.ride.matching.scoring-weights.time-alignment=0.3
app.ride.matching.scoring-weights.driver-rating=0.2
app.ride.matching.scoring-weights.detour-penalty=0.1
app.ride.matching.driver-response-seconds=90

# Broadcast Fallback Configuration
# Note: Broadcast window is calculated dynamically as (15 min total - time already spent in sequential matching)
# Individual driver response window during broadcast: 30 seconds
app.ride.broadcast.response-window-seconds=30

# Cancellation Configuration
app.ride.cancellation.grace-period-minutes=2
app.ride.cancellation.fee-percentage=0.20

app.websocket.use-rabbitmq=true

# Main feature toggle - set to false to use legacy in-memory coordinator
app.messaging.ride.enabled=true

# Matching orchestrator toggle - set to false to use legacy mode
app.messaging.ride.matching-enabled=true

# Notifications via MQ toggle - set to false to use direct service calls
app.messaging.ride.notifications-enabled=true

# Exchange and routing configuration
app.messaging.ride.exchange=ride.events
app.messaging.ride.ride-request-created-routing-key=ride.request.created
app.messaging.ride.ride-request-created-queue=ride.request.created.queue
app.messaging.ride.matching-command-routing-key=ride.matching.command
app.messaging.ride.matching-command-queue=ride.matching.command.queue
app.messaging.ride.notification-routing-key=ride.notifications
app.messaging.ride.notification-queue=ride.notifications.queue
app.messaging.ride.driver-timeout-delay-queue=ride.matching.delay.driver-timeout
app.messaging.ride.broadcast-timeout-delay-queue=ride.matching.delay.broadcast-timeout
app.messaging.ride.driver-location-routing-key=ride.location.driver
app.messaging.ride.driver-location-queue=ride.location.driver.queue

# Timeouts and windows (ISO 8601 Duration format)
# Driver response window during sequential matching phase
app.messaging.ride.driver-response-window=PT90S
# Total matching request timeout: 15 minutes (sequential + broadcast combined)
app.messaging.ride.matching-request-timeout=PT15M

# RabbitMQ AMQP Configuration (for Spring Boot connection)
spring.rabbitmq.host=${RABBITMQ_HOST:fuji-01.lmq.cloudamqp.com}
spring.rabbitmq.port=${RABBITMQ_PORT:5671}
spring.rabbitmq.username=${RABBITMQ_USERNAME:liusoksk}
spring.rabbitmq.password=${RABBITMQ_PASSWORD:j2MK5FzAmBca8HJX5_mKitrKLwZU41ir}
spring.rabbitmq.virtual-host=${RABBITMQ_VHOST:liusoksk}

# RabbitMQ SSL Configuration (for CloudAMQP)
spring.rabbitmq.ssl.enabled=${RABBITMQ_SSL_ENABLED:true}
spring.rabbitmq.ssl.algorithm=TLSv1.2
spring.rabbitmq.ssl.validate-server-certificate=${RABBITMQ_VALIDATE_CERT:true}
spring.rabbitmq.ssl.verify-hostname=${RABBITMQ_VERIFY_HOST:true}


# RabbitMQ STOMP Configuration (for WebSocket broker relay)
spring.rabbitmq.stomp.host=localhost
spring.rabbitmq.stomp.port=61613
spring.rabbitmq.stomp.username=guest
spring.rabbitmq.stomp.password=guest

app.timezone=Asia/Ho_Chi_Minh

# SOS feature defaults
app.sos.fallback-emergency-number=113
app.sos.acknowledgement-timeout=PT120S
app.sos.escalation-interval=PT30S
app.sos.auto-call-enabled=true
app.sos.admin-user-ids=
app.sos.campus-security-phones=
app.sos.trigger-hold-duration=PT5S

twilio.account-sid=${TWILIO_ACCOUNT_SID:ACd1c776219dd9802a42ff12b07077c363}
twilio.auth-token=${TWILIO_AUTH_TOKEN:87e6adad7fef765fd59ec2f102f5bead}
twilio.phone-number=${TWILIO_FROM_PHONE_NUMBER:+12183876157}


# Enable/disable AI features globally
app.ai.enabled=${AI_ENABLED:true}

# AI Provider: "xai" (Grok) or "openai" (GPT)
app.ai.provider=${AI_PROVIDER:ollama}

# AI API Configuration
# For xAI: https://api.x.ai/v1/chat/completions
# For OpenAI: https://api.openai.com/v1/chat/completions
app.ai.api-url=${AI_API_URL:http://localhost:11434/v1/chat/completions}

# AI Model
# xAI: "grok-beta" | OpenAI: "gpt-4o-mini"
app.ai.model=${AI_MODEL:mistral:latest}

# AI API Key (MUST be set via environment variable)
# Ollama local API does not require a key, but leave a placeholder to satisfy validation.
app.ai.api-key=${AI_API_KEY:ollama}

# Request timeout and retry configuration
app.ai.timeout-seconds=5
app.ai.max-retries=1
app.ai.fallback-to-base-algorithm=true

# AI Model parameters
app.ai.temperature=0.3
app.ai.max-tokens=50
app.ai.cache-duration-minutes=5
app.ai.max-candidates-for-ai=10

# Pattern Analysis Configuration
app.ai.pattern-analysis.enabled=true
app.ai.pattern-analysis.schedule=0 0 3 * * *
app.ai.pattern-analysis.historical-days=30
app.ai.pattern-analysis.min-rides-for-analysis=10
app.ai.pattern-analysis.cache-hours=24
