# Error Catalog for MSSUS Backend
# Format: <domain>.<category>.<name>
# Domain: auth, user, wallet, notification, system
# Category: validation, not-found, conflict, unauthorized, internal, operation
# HTTP Status derived from first digit: 4xx -> 400-level, 5xx -> 500-level

errors:
  # Authentication & Authorization Errors
  - id: auth.validation.missing-credential
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Yêu cầu thông tin xác thực"
    domain: auth
    category: validation
    owner: auth-team
    remediation: "Provide valid credentials in the request"

  - id: auth.validation.invalid-credentials
    httpStatus: 401
    severity: WARN
    isRetryable: false
    messageTemplate: "Tên người dùng hoặc mật khẩu không đúng. Vui lòng kiểm tra lại thông tin và thử lại."
    domain: auth
    category: validation
    owner: auth-team
    remediation: "Check credentials and try again"

  - id: auth.unauthorized.token-expired
    httpStatus: 401
    severity: INFO
    isRetryable: true
    messageTemplate: "Phiên xác thực đã hết hạn"
    domain: auth
    category: unauthorized
    owner: auth-team
    remediation: "Refresh your authentication token"

  - id: auth.unauthorized.token-invalid
    httpStatus: 401
    severity: WARN
    isRetryable: false
    messageTemplate: "Phiên xác thực không hợp lệ"
    domain: auth
    category: unauthorized
    owner: auth-team
    remediation: "Provide a valid authentication token"

  - id: auth.unauthorized.refresh-token-invalid
    httpStatus: 401
    severity: WARN
    isRetryable: false
    messageTemplate: "Phiên đăng nhập không hợp lệ"
    domain: auth
    category: unauthorized
    owner: auth-team
    remediation: "Login again to obtain a new refresh token"

  - id: auth.unauthorized.access-denied
    httpStatus: 403
    severity: WARN
    isRetryable: false
    messageTemplate: "Bạn không có quyền truy cập tài nguyên này"
    domain: auth
    category: unauthorized
    owner: auth-team
    remediation: "Contact administrator for access permissions"

  - id: auth.unauthorized.account-pending
    httpStatus: 403
    severity: INFO
    isRetryable: false
    messageTemplate: "Tài khoản đang chờ phê duyệt"
    domain: auth
    category: unauthorized
    owner: auth-team
    remediation: "Wait for account approval"

  - id: auth.unauthorized.account-suspended
    httpStatus: 403
    severity: WARN
    isRetryable: false
    messageTemplate: "Tài khoản của bạn đã bị đình chỉ. Vui lòng liên hệ hỗ trợ để được trợ giúp."
    domain: auth
    category: unauthorized
    owner: auth-team
    remediation: "Contact support for account status"

  - id: auth.unauthorized.email-verification-pending
    httpStatus: 403
    severity: WARN
    isRetryable: true
    messageTemplate: "Vui lòng xác minh email của bạn"
    domain: user
    category: validation
    owner: user-team
    remediation: "Retry OTP verification"


  # User Management Errors
  - id: user.not-found.by-id
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy người dùng"
    domain: user
    category: not-found
    owner: user-team

  - id: user.not-found.by-email
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy người dùng"
    domain: user
    category: not-found
    owner: user-team

  - id: user.conflict.email-exists
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Địa chỉ email đã tồn tại. Vui lòng sử dụng email khác hoặc khôi phục tài khoản hiện có."
    domain: user
    category: conflict
    owner: user-team
    remediation: "Use a different email address or recover existing account"

  - id: user.conflict.username-exists
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Tên người dùng đã tồn tại"
    domain: user
    category: conflict
    owner: user-team
    remediation: "Choose a different username"

  - id: user.conflict.phone-exists
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Số điện thoại đã tồn tại. Vui lòng sử dụng số điện thoại khác."
    domain: user
    category: conflict
    owner: user-team
    remediation: "Choose a different phone"

  - id: user.validation.invalid-email
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Định dạng email không hợp lệ. Vui lòng nhập địa chỉ email hợp lệ."
    domain: user
    category: validation
    owner: user-team
    remediation: "Provide a valid email address"

  - id: user.validation.password-too-weak
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt."
    domain: user
    category: validation
    owner: user-team
    remediation: "Password must be at least 8 characters with mixed case, numbers, and symbols"

  - id: user.validation.profile-not-exists
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Hồ sơ người dùng không tồn tại"
    domain: user
    category: validation
    owner: user-team
    remediation: "Check profile fields and try again"

  - id: user.validation.profile-not-active
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Hồ sơ người dùng không hoạt động"
    domain: user
    category: validation
    owner: user-team
    remediation: "Contact support to activate your profile"

  - id: otp.validation.invalid-otp
    httpStatus: 400
    severity: WARN
    isRetryable: true
    messageTemplate: "Mã OTP không hợp lệ hoặc đã hết hạn. Vui lòng kiểm tra mã và thử lại."
    domain: otp
    category: validation
    owner: otp-team
    remediation: "Check the OTP code and try again"


  # Wallet Management Errors
  - id: wallet.not-found.by-user
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy ví cho người dùng"
    domain: wallet
    category: not-found
    owner: wallet-team

  - id: wallet.conflict.already-exists
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Ví đã tồn tại cho người dùng này"
    domain: wallet
    category: conflict
    owner: wallet-team

  - id: wallet.operation.insufficient-balance
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Số dư ví không đủ cho thao tác này."
    domain: wallet
    category: operation
    owner: wallet-team
    remediation: "Add funds to your wallet or reduce the transaction amount"

  - id: wallet.operation.inactive-wallet
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Ví không hoạt động và không thể sử dụng"
    domain: wallet
    category: operation
    owner: wallet-team
    remediation: "Contact support to reactivate your wallet"

  - id: wallet.operation.failed
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: "Thao tác ví thất bại"
    domain: wallet
    category: operation
    owner: wallet-team
    remediation: "Try again later or contact support if the issue persists"

  # Notification Errors
  - id: notification.operation.email-send-failed
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: "Gửi thông báo qua email thất bại"
    domain: notification
    category: operation
    owner: notification-team

  - id: notification.operation.sms-send-failed
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: "Gửi thông báo qua SMS thất bại"
    domain: notification
    category: operation
    owner: notification-team

  - id: notification.operation.template-not-found
    httpStatus: 500
    severity: ERROR
    isRetryable: false
    messageTemplate: "Không tìm thấy mẫu email"
    domain: notification
    category: operation
    owner: notification-team

  # Validation Errors
  - id: validation.request.invalid-body
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Nội dung yêu cầu không hợp lệ"
    domain: validation
    category: validation
    owner: platform-team

  - id: validation.request.missing-parameter
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Thiếu tham số yêu cầu bắt buộc"
    domain: validation
    category: validation
    owner: platform-team

  - id: validation.request.invalid-parameter-type
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Tham số yêu cầu có loại không hợp lệ"
    domain: validation
    category: validation
    owner: platform-team

  - id: validation.file.size-exceeded
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Dung lượng tệp vượt quá giới hạn tối đa {maxSize}MB. Vui lòng giảm dung lượng tệp và thử lại."
    domain: validation
    category: validation
    owner: platform-team
    remediation: "Reduce file size and try again"

  # System Errors
  - id: system.internal.unexpected
    httpStatus: 500
    severity: ERROR
    isRetryable: false
    messageTemplate: "Đã xảy ra lỗi không mong muốn"
    domain: system
    category: internal
    owner: platform-team

  - id: system.internal.database-error
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: "Thao tác cơ sở dữ liệu thất bại"
    domain: system
    category: internal
    owner: platform-team

  - id: system.internal.service-unavailable
    httpStatus: 503
    severity: ERROR
    isRetryable: true
    messageTemplate: "Dịch vụ tạm thời không khả dụng"
    domain: system
    category: internal
    owner: platform-team
    remediation: "Please try again later"

  - id: system.not-found.resource
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy tài nguyên được yêu cầu"
    domain: system
    category: not-found
    owner: platform-team
    remediation: "Check the resource identifier and try again"

  - id: pricing-config.not-found.resource
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy cấu hình giá đang hoạt động"
    domain: pricing-config
    category: not-found
    owner: pricing-team
    remediation: "Contact support to set up pricing configuration"

  - id: pricing.validation.no-tiers-configured
    httpStatus: 500
    severity: ERROR
    isRetryable: false
    messageTemplate: "Cấu hình giá ID {pricingConfigId} không có bậc giá nào được định nghĩa."
    domain: pricing
    category: validation
    owner: pricing-team
    remediation: "Ensure that the active pricing configuration has at least one fare tier defined in the database."

  - id: pricing.validation.no-matching-tier
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Không tìm thấy bậc giá phù hợp cho khoảng cách {distanceKm} km. Vui lòng kiểm tra lại cấu hình giá."
    domain: pricing
    category: validation
    owner: pricing-team
    remediation: "The provided distance does not fall into any defined fare tier range. This may indicate a gap in the pricing configuration (e.g., tier 1 is 0-5km, tier 2 is 6-10km, leaving 5-6km undefined)."


  # =========================================================================
  # Ride Module Errors (Ride Booking & Sharing)
  # =========================================================================
  
  # Ride Not Found Errors
  - id: ride.not-found.resource
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy chuyến đi chung với ID: {rideId}"
    domain: ride
    category: not-found
    owner: ride-team
    remediation: "Verify the ride ID and try again"

  - id: ride.not-found.request
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy yêu cầu chuyến đi với ID: {requestId}"
    domain: ride
    category: not-found
    owner: ride-team
    remediation: "Verify the request ID and try again"

  # Ride Ownership & Authorization Errors
  - id: ride.unauthorized.not-owner
    httpStatus: 403
    severity: WARN
    isRetryable: false
    messageTemplate: "Bạn không phải là chủ của chuyến đi này"
    domain: ride
    category: unauthorized
    owner: ride-team
    remediation: "Only the ride owner can perform this action"

  - id: ride.unauthorized.request-not-owner
    httpStatus: 403
    severity: WARN
    isRetryable: false
    messageTemplate: "Bạn không phải là người tạo yêu cầu chuyến đi này"
    domain: ride
    category: unauthorized
    owner: ride-team
    remediation: "Only the request owner can perform this action"

  - id: ride.unauthorized.invalid-profile
    httpStatus: 403
    severity: WARN
    isRetryable: false
    messageTemplate: "Hồ sơ của bạn không được phép thực hiện hành động này"
    domain: ride
    category: unauthorized
    owner: ride-team
    remediation: "Ensure your profile meets the requirements for this action"

  # Ride Validation Errors
  - id: ride.validation.no-seats-available
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Không còn ghế trống trên chuyến đi này"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Choose a different ride or wait for another ride"

  - id: ride.validation.invalid-state
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Chuyến đi đang ở trạng thái không hợp lệ cho thao tác này: {currentState}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "This operation can only be performed on rides in specific states"

  - id: ride.validation.request-invalid-state
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Yêu cầu đang ở trạng thái không hợp lệ cho thao tác này: {currentState}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "This operation can only be performed on requests in specific states"

  - id: ride.validation.invalid-location
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Cấu hình vị trí không hợp lệ: {reason}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Check pickup and dropoff locations are valid and on route"

  - id: ride.validation.route-validation-failed
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Xác thực tuyến đường thất bại: {reason}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Ensure the route is valid and reachable"

  - id: ride.validation.time-conflict
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Xung đột thời gian: {reason}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Adjust pickup or scheduled time to avoid conflicts"

  - id: ride.validation.service-area-violation
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Vi phạm khu vực dịch vụ: {reason}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Ensure pickup and dropoff locations are within service areas"

  - id: ride.validation.missing-current-location
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Yêu cầu vị trí hiện tại cho thao tác này"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Provide your current location"

  - id: ride.validation.vehicle-not-found
    httpStatus: 404
    severity: WARN
    isRetryable: false
    messageTemplate: "Không tìm thấy phương tiện"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Verify the vehicle registration and try again"

  - id: ride-request.validation.invalid-state
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: "Yêu cầu chuyến đi đang ở trạng thái không hợp lệ cho thao tác này: {currentState}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "This operation can only be performed on ride requests in specific states"

  - id: ride.validation.too-far-from-dropoff
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Vị trí hiện tại của bạn quá xa điểm thả khách đã chỉ định"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Move closer to the dropoff location to proceed"

  - id: ride.validation.incomplete-requests
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Không thể bắt đầu chuyến đi vì có yêu cầu chia sẻ chuyến đi chưa hoàn thành"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Ensure all ride requests are completed before starting the ride"

  - id: ride.validation.invalid-scheduled-time
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: "Thời gian lên lịch cho chuyến đi chia sẻ không hợp lệ: {reason}"
    domain: ride
    category: validation
    owner: ride-team
    remediation: "Provide a valid scheduled time in the future"

  # Ride Operation Errors
  - id: ride.operation.wallet-hold-failed
    httpStatus: 402
    severity: WARN
    isRetryable: true
    messageTemplate: "Không thể tạm giữ tiền trong ví: {reason}"
    domain: ride
    category: operation
    owner: ride-team
    remediation: "Ensure sufficient balance in wallet and retry"

  - id: ride.operation.matching-failed
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: "Ghép chuyến xe chia sẻ thất bại: {reason}"
    domain: ride
    category: operation
    owner: ride-team
    remediation: "Retry the matching request or contact support"

  - id: ride.operation.no-matches-found
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy chuyến đi phù hợp cho yêu cầu của bạn"
    domain: ride
    category: operation
    owner: ride-team
    remediation: "Try adjusting your pickup time or location"

  - id: ride.operation.request-expired
    httpStatus: 410
    severity: INFO
    isRetryable: false
    messageTemplate: "Yêu cầu chuyến đi đã hết hạn (không có tài xế nào chấp nhận trong khoảng thời gian chờ)"
    domain: ride
    category: operation
    owner: ride-team
    remediation: "Create a new ride request"

  - id: ride.operation.cancellation-fee-required
    httpStatus: 402
    severity: WARN
    isRetryable: true
    messageTemplate: "Phí hủy chuyến muộn {feeAmount} VND đã được áp dụng vào tài khoản của bạn."
    domain: ride
    category: operation
    owner: ride-team
    remediation: "Ensure sufficient balance to cover cancellation fee"

  - id: ride-request.settlement.failed
    httpStatus: 500
    severity: WARN
    isRetryable: true
    messageTemplate: "Thanh toán yêu cầu chuyến đi chia sẻ thất bại: {reason}"
    domain: ride
    category: operation
    owner: ride-team
    remediation: "Retry the settlement or contact support"

  # Notification Errors
  - id: notification.not-found.by-id
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: "Không tìm thấy thông báo với ID: {notificationId}"
    domain: notification
    category: not-found
    owner: notification-team
    remediation: "Verify the notification ID and try again"
  # SOS & Safety Errors
  - id: sos.contact.invalid-name
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: 'Emergency contact name is required.'
    domain: sos
    category: validation
    owner: safety-team
    remediation: 'Provide a non-empty name for the emergency contact.'

  - id: sos.contact.invalid-phone
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: 'Emergency contact phone number is required.'
    domain: sos
    category: validation
    owner: safety-team
    remediation: 'Provide a valid phone number (E.164 format recommended).'

  - id: sos.contact.not-found
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: 'Emergency contact not found for this user.'
    domain: sos
    category: not-found
    owner: safety-team

  - id: sos.alert.invalid-user
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: 'Authenticated user is required to trigger SOS.'
    domain: sos
    category: validation
    owner: safety-team

  - id: sos.alert.invalid-request
    httpStatus: 400
    severity: WARN
    isRetryable: false
    messageTemplate: 'SOS trigger request is invalid or missing data.'
    domain: sos
    category: validation
    owner: safety-team

  - id: sos.alert.ride-not-found
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: 'Shared ride not found for SOS reference.'
    domain: sos
    category: not-found
    owner: safety-team

  - id: sos.alert.not-found
    httpStatus: 404
    severity: INFO
    isRetryable: false
    messageTemplate: 'SOS alert not found.'
    domain: sos
    category: not-found
    owner: safety-team

  - id: sos.alert.already-resolved
    httpStatus: 409
    severity: WARN
    isRetryable: false
    messageTemplate: 'SOS alert has already been resolved.'
    domain: sos
    category: conflict
    owner: safety-team

  - id: sos.alert.access-denied
    httpStatus: 403
    severity: WARN
    isRetryable: false
    messageTemplate: 'You do not have permission to view this SOS alert.'
    domain: sos
    category: unauthorized
    owner: safety-team
    remediation: 'Only administrators or the alert owner can access this record.'

  - id: sos.alert.contact-serialization-error
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: 'Failed to serialize emergency contact information for SOS dispatch.'
    domain: sos
    category: internal
    owner: safety-team

  - id: sos.alert.notification-payload-error
    httpStatus: 500
    severity: ERROR
    isRetryable: true
    messageTemplate: 'Failed to build notification payload for SOS alert.'
    domain: sos
    category: internal
    owner: safety-team
